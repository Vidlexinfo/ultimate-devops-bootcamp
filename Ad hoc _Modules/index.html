<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Ad hoc  Modules - Ultimate Devops Bootcamp</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Ad hoc  Modules";
    var mkdocs_page_input_path = "Ad hoc _Modules.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Ultimate Devops Bootcamp</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../preface/">Outline</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../ansible_docs/">Ansible</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../docker_index/">Docker</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">CI-CD</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../020_install_jenkins_jfrog_artifactory/">Jenkins</a>
                </li>
                <li class="">
                    
    <a class="" href="../030_install_plugins/">Jenkins configurations</a>
                </li>
                <li class="">
                    
    <a class="" href="../040_jenkins_config/">Jenkins Tools configurations</a>
                </li>
                <li class="">
                    
    <a class="" href="../050_jenkins_jobs/">Creating First Project</a>
                </li>
                <li class="">
                    
    <a class="" href="../060_building_jobs_pipeline/">Building Jobs Pipeline</a>
                </li>
                <li class="">
                    
    <a class="" href="../070_frontend/">Build pipeline for Front End</a>
                </li>
                <li class="">
                    
    <a class="" href="../080_catalogue/">Build pipeline for Catalogue</a>
                </li>
                <li class="">
                    
    <a class="" href="../090_carts/">Build Pipeline for Cart</a>
                </li>
                <li class="">
                    
    <a class="" href="../010_docker_envi/">010 docker envi</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Ultimate Devops Bootcamp</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Ad hoc  Modules</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h3 id="ad-hoc-management-with-modules">Ad hoc management with Modules</h3>
<p>The default configurations for ansible resides at /etc/ansible/ansible.cfg. Instead of relying on defaults, we are going to creates a custom configuration file for our project. The advantage with that is we could take this configurations on any host and execute it the same way, without touching the default system configurations. This custom configurations will essentially override the values in /etc/ansible/ansible/cfg.</p>
<p>Validate that your new configs are picked up,</p>
<pre><code>ansible --version
ansible-config dump
</code></pre>

<h4 id="ansible-ping">Ansible ping</h4>
<pre><code>ansible all -m ping
</code></pre>

<p>[output]</p>
<pre><code>192.168.61.12 | SUCCESS =&gt; {
    &quot;changed&quot;: false,
    &quot;ping&quot;: &quot;pong&quot;
}
192.168.61.11 | SUCCESS =&gt; {
    &quot;changed&quot;: false,
    &quot;ping&quot;: &quot;pong&quot;
}
192.168.61.13 | SUCCESS =&gt; {
    &quot;changed&quot;: false,
    &quot;ping&quot;: &quot;pong&quot;
}

</code></pre>

<h4 id="ad-hoc-commands">Ad Hoc commands</h4>
<p>Try running following <em>fire-and-forget</em> Ad-Hoc commands...</p>
<h4 id="run-hostname-command-on-all-hosts">Run <em>hostname</em> command on all hosts</h4>
<p>Let us print the hostname of all the hosts</p>
<pre><code>ansible all -a hostname
</code></pre>

<p>[output]</p>
<pre><code>localhost | SUCCESS | rc=0 &gt;&gt;
ansible

192.168.61.11 | SUCCESS | rc=0 &gt;&gt;
db

192.168.61.12 | SUCCESS | rc=0 &gt;&gt;
app

192.168.61.13 | SUCCESS | rc=0 &gt;&gt;
app
</code></pre>

<h3 id="check-the-uptime">Check the <em>uptime</em></h3>
<p>How long the hosts are <em>up</em>?</p>
<pre><code>ansible all -a uptime
</code></pre>

<p>[Output]</p>
<pre><code>localhost | SUCCESS | rc=0 &gt;&gt;
 13:17:13 up  2:21,  1 user,  load average: 0.16, 0.03, 0.01

192.168.61.12 | SUCCESS | rc=0 &gt;&gt;
 13:17:14 up  1:50,  2 users,  load average: 0.00, 0.00, 0.00

192.168.61.13 | SUCCESS | rc=0 &gt;&gt;
 13:17:14 up  1:47,  2 users,  load average: 0.00, 0.00, 0.00

192.168.61.11 | SUCCESS | rc=0 &gt;&gt;
 13:17:14 up  1:36,  2 users,  load average: 0.00, 0.00, 0.00
</code></pre>

<h3 id="check-memory-info-on-app-servers">Check memory info on app servers</h3>
<p>Does my app servers have any disk space <em>free</em>?</p>
<pre><code>ansible app -a free
</code></pre>

<p>[Output]</p>
<pre><code>192.168.61.13 | SUCCESS | rc=0 &gt;&gt;
             total       used       free     shared    buffers     cached
Mem:        372916     121480     251436        776      11160      46304
-/+ buffers/cache:      64016     308900
Swap:      4128764          0    4128764

192.168.61.12 | SUCCESS | rc=0 &gt;&gt;
             total       used       free     shared    buffers     cached
Mem:        372916     121984     250932        776      11228      46336
-/+ buffers/cache:      64420     308496
Swap:      4128764          0    4128764
</code></pre>

<h3 id="installing-packages">Installing packages</h3>
<p>Let us <em>install</em> Docker on app servers</p>
<pre><code>ansible app -a &quot;yum install -y docker-engine&quot;
</code></pre>

<p>This command will fail.</p>
<p>[Output]</p>
<pre><code>192.168.61.13 | FAILED | rc=1 &gt;&gt;
Loaded plugins: fastestmirror, prioritiesYou need to be root to perform this command.

192.168.61.12 | FAILED | rc=1 &gt;&gt;
Loaded plugins: fastestmirror, prioritiesYou need to be root to perform this command.
</code></pre>

<p>Run the fillowing command with sudo permissions.</p>
<pre><code>ansible app -s -a &quot;yum install -y docker-engine&quot;
</code></pre>

<p>This will install docker in our app servers</p>
<p>[Output]</p>
<pre><code>192.168.61.12 | SUCCESS | rc=0 &gt;&gt;
Loaded plugins: fastestmirror, priorities
Setting up Install Process
Loading mirror speeds from cached hostfile
 * base: mirrors.nhanhoa.com
 * epel: mirror.rise.ph
 * extras: mirror.fibergrid.in
 * updates: mirror.fibergrid.in
283 packages excluded due to repository priority protections
Resolving Dependencies
--&gt; Running transaction check
---&gt; Package docker-engine.x86_64 0:1.7.1-1.el6 will be installed
--&gt; Finished Dependency Resolution

Dependencies Resolved

================================================================================
 Package             Arch         Version              Repository          Size
================================================================================
Installing:
 docker-engine       x86_64       1.7.1-1.el6          local_docker       4.5 M

Transaction Summary
================================================================================
Install       1 Package(s)

Total download size: 4.5 M
Installed size: 19 M
Downloading Packages:
Running rpm_check_debug
Running Transaction Test
Transaction Test Succeeded
Running Transaction
  Installing : docker-engine-1.7.1-1.el6.x86_64                             1/1
  Verifying  : docker-engine-1.7.1-1.el6.x86_64                             1/1

Installed:
  docker-engine.x86_64 0:1.7.1-1.el6

Complete!

192.168.61.13 | SUCCESS | rc=0 &gt;&gt;
Loaded plugins: fastestmirror, priorities
Setting up Install Process
Loading mirror speeds from cached hostfile
 * base: mirror.fibergrid.in
 * epel: mirror.rise.ph
 * extras: mirror.fibergrid.in
 * updates: mirror.fibergrid.in
283 packages excluded due to repository priority protections
Resolving Dependencies
--&gt; Running transaction check
---&gt; Package docker-engine.x86_64 0:1.7.1-1.el6 will be installed
--&gt; Finished Dependency Resolution

Dependencies Resolved

================================================================================
 Package             Arch         Version              Repository          Size
================================================================================
Installing:
 docker-engine       x86_64       1.7.1-1.el6          local_docker       4.5 M

Transaction Summary
================================================================================
Install       1 Package(s)

Total download size: 4.5 M
Installed size: 19 M
Downloading Packages:
Running rpm_check_debug
Running Transaction Test
Transaction Test Succeeded
Running Transaction
  Installing : docker-engine-1.7.1-1.el6.x86_64                             1/1
  Verifying  : docker-engine-1.7.1-1.el6.x86_64                             1/1

Installed:
  docker-engine.x86_64 0:1.7.1-1.el6

Complete!
</code></pre>

<h3 id="running-commands-one-machine-at-a-time">Running commands one machine at a time</h3>
<p>Do you want a command to run on <em>one machine at a time</em> ?</p>
<pre><code>ansible all -f 1 -a &quot;free&quot;
</code></pre>

<h2 id="using-modules-to-manage-the-state-of-infrastructure">Using <em>modules</em> to manage the state of infrastructure</h2>
<h3 id="creating-users-and-groups-using-user-and-group">Creating users and groups using <em>user</em> and <em>group</em></h3>
<p>To create a group</p>
<pre><code>ansible app -s -m group -a &quot;name=admin state=present&quot;
</code></pre>

<p>The output will be,</p>
<pre><code>192.168.61.13 | SUCCESS =&gt; {
    &quot;changed&quot;: true,
    &quot;gid&quot;: 501,
    &quot;name&quot;: &quot;admin&quot;,
    &quot;state&quot;: &quot;present&quot;,
    &quot;system&quot;: false
}
192.168.61.12 | SUCCESS =&gt; {
    &quot;changed&quot;: true,
    &quot;gid&quot;: 501,
    &quot;name&quot;: &quot;admin&quot;,
    &quot;state&quot;: &quot;present&quot;,
    &quot;system&quot;: false
}
</code></pre>

<p>To create a user</p>
<pre><code>ansible app -s -m user -a &quot;name=devops group=admin createhome=yes&quot;
</code></pre>

<p>This will create user <em>devops</em>,</p>
<pre><code>192.168.61.13 | SUCCESS =&gt; {
    &quot;changed&quot;: true,
    &quot;comment&quot;: &quot;&quot;,
    &quot;createhome&quot;: true,
    &quot;group&quot;: 501,
    &quot;home&quot;: &quot;/home/devops&quot;,
    &quot;name&quot;: &quot;devops&quot;,
    &quot;shell&quot;: &quot;/bin/bash&quot;,
    &quot;state&quot;: &quot;present&quot;,
    &quot;system&quot;: false,
    &quot;uid&quot;: 501
}
192.168.61.12 | SUCCESS =&gt; {
    &quot;changed&quot;: true,
    &quot;comment&quot;: &quot;&quot;,
    &quot;createhome&quot;: true,
    &quot;group&quot;: 501,
    &quot;home&quot;: &quot;/home/devops&quot;,
    &quot;name&quot;: &quot;devops&quot;,
    &quot;shell&quot;: &quot;/bin/bash&quot;,
    &quot;state&quot;: &quot;present&quot;,
    &quot;system&quot;: false,
    &quot;uid&quot;: 501
}
</code></pre>

<h3 id="copy-a-file-using-copy-modules">Copy a file using <em>copy</em> modules</h3>
<p>We will copy file from control node to app servers.</p>
<pre><code>ansible app -m copy -a &quot;src=/vagrant/test.txt dest=/tmp/test.txt&quot;
</code></pre>

<p>File will be copied over to our app server machines...</p>
<pre><code>192.168.61.13 | SUCCESS =&gt; {
    &quot;changed&quot;: true,
    &quot;checksum&quot;: &quot;3160f8f941c330444aac253a9e6420cd1a65bfe2&quot;,
    &quot;dest&quot;: &quot;/tmp/test.txt&quot;,
    &quot;gid&quot;: 500,
    &quot;group&quot;: &quot;vagrant&quot;,
    &quot;md5sum&quot;: &quot;9052de4cff7e8a18de586f785e711b97&quot;,
    &quot;mode&quot;: &quot;0664&quot;,
    &quot;owner&quot;: &quot;vagrant&quot;,
    &quot;size&quot;: 11,
    &quot;src&quot;: &quot;/home/vagrant/.ansible/tmp/ansible-tmp-1472991990.29-63683023616899/source&quot;,
    &quot;state&quot;: &quot;file&quot;,
    &quot;uid&quot;: 500
}
192.168.61.12 | SUCCESS =&gt; {
    &quot;changed&quot;: true,
    &quot;checksum&quot;: &quot;3160f8f941c330444aac253a9e6420cd1a65bfe2&quot;,
    &quot;dest&quot;: &quot;/tmp/test.txt&quot;,
    &quot;gid&quot;: 500,
    &quot;group&quot;: &quot;vagrant&quot;,
    &quot;md5sum&quot;: &quot;9052de4cff7e8a18de586f785e711b97&quot;,
    &quot;mode&quot;: &quot;0664&quot;,
    &quot;owner&quot;: &quot;vagrant&quot;,
    &quot;size&quot;: 11,
    &quot;src&quot;: &quot;/home/vagrant/.ansible/tmp/ansible-tmp-1472991990.26-218089785548663/source&quot;,
    &quot;state&quot;: &quot;file&quot;,
    &quot;uid&quot;: 500
}

</code></pre>
              
            </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>

</body>
</html>
